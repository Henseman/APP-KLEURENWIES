<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kleurenwies Score App</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #2c3e50;
            color: white;
        }
        .button {
            width: 120px;
            height: 50px;
            font-size: 16px;
            margin: 5px;
            cursor: pointer;
            border: none;
            color: white;
            border-radius: 8px;
        }
        .active { background-color: green; }
        .inactive { background-color: red; }
        .neutral { background-color: #3498db; }
        .container { display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; }
        input { padding: 10px; margin: 5px; font-size: 16px; }
        table { width: 50%; margin: auto; border-collapse: collapse; }
        th, td { border: 1px solid white; padding: 10px; text-align: center; }
        th { background-color: darkred; }
    </style>
</head>
<body>
    <h2>Kleurenwies Score App</h2>
    
    <h3>Spelersnamen instellen:</h3>
    <input type="text" id="speler1" placeholder="Speler 1" oninput="updateNamen()">
    <input type="text" id="speler2" placeholder="Speler 2" oninput="updateNamen()">
    <input type="text" id="speler3" placeholder="Speler 3" oninput="updateNamen()">
    <input type="text" id="speler4" placeholder="Speler 4" oninput="updateNamen()">
    
    <h3>Ronde: <span id="ronde">1</span> | Gever: <span id="gever">Speler 1</span></h3>

    <h3>Kies een contract:</h3>
    <div class="container" id="contract-container"></div>
    
    <h3>Wie zet?</h3>
    <div class="container" id="zetter-container"></div>

    <h3>Wie speelt mee?</h3>
    <div class="container" id="teamgenoten-container"></div>
    
    <h3>Behaalde slagen:</h3>
    <div class="container" id="slagen-container"></div>
    
    <br>
    <button class="button neutral" onclick="berekenScore()">Bereken Score</button>
    <button class="button neutral" onclick="resetScores()">Reset Scores</button>
    
    <h3>Huidige Scores:</h3>
    <table>
        <tr>
            <th>Speler</th>
            <th>Score</th>
        </tr>
        <tr><td id="naam1">Speler 1</td><td id="score1">0</td></tr>
        <tr><td id="naam2">Speler 2</td><td id="score2">0</td></tr>
        <tr><td id="naam3">Speler 3</td><td id="score3">0</td></tr>
        <tr><td id="naam4">Speler 4</td><td id="score4">0</td></tr>
    </table>

    <h3>Historiek:</h3>
    <div id="historiek"></div>

    <script>
        const contracten = ["Samen 8", "Solo 5", "Samen 9", "Solo 6", "Samen 10", "Solo 7", "Samen 11", "Kleine Miserie", "Samen 12", "Solo 8", "Piccolo", "Samen 13", "Solo 9", "Troel 8", "Miserie", "Solo 10", "Solo 11", "Open Miserie", "Solo 12", "Solo Slim 13"];
        const spelers = ["speler1", "speler2", "speler3", "speler4"];
        let geselecteerdContract = "";
        let geselecteerdeZetter = "";
        let geselecteerdeTeamgenoten = [];
        let geselecteerdeSlagen = 0;

        function updateNamen() {
            spelers.forEach((id, index) => {
                document.getElementById("naam" + (index + 1)).innerText = document.getElementById(id).value || `Speler ${index + 1}`;
            });
            updateUI();
        }

        function updateUI() {
            document.getElementById("contract-container").innerHTML = contracten.map(contract => `<button class="button neutral" onclick="selectContract('${contract}')">${contract}</button>`).join('');
            document.getElementById("zetter-container").innerHTML = spelers.map((id, index) => `<button class="button neutral" id="zetter${index}" onclick="selectZetter(${index})">${document.getElementById(id).value || `Speler ${index + 1}`}</button>`).join('');
            document.getElementById("slagen-container").innerHTML = [...Array(14).keys()].map(num => `<button class="button neutral" onclick="selectSlagen(${num})">${num}</button>`).join('');
        }

        function selectContract(contract) {
            geselecteerdContract = contract;
            updateUI();
        }

        function selectZetter(index) {
            geselecteerdeZetter = index;
            geselecteerdeTeamgenoten = [];
            updateUI();
        }

        function selectSlagen(aantal) {
            geselecteerdeSlagen = aantal;
            updateUI();
        }

        function berekenScore() {
            fetch('/bereken', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contract: geselecteerdContract, zetter: geselecteerdeZetter, slagen: geselecteerdeSlagen, teamgenoten: geselecteerdeTeamgenoten })
            }).then(response => response.json()).then(data => {
                updateScores(data);
            }).catch(error => console.error("Fout bij berekenen van score:", error));
        }

        function updateScores(scores) {
            Object.keys(scores.scores).forEach((speler, index) => {
                document.getElementById("score" + (index + 1)).innerText = scores.scores[speler];
            });
        }

        function resetScores() {
            fetch('/reset', { method: 'POST' }).then(() => {
                alert("Scores gereset!");
                updateUI();
            }).catch(error => console.error("Fout bij resetten van scores:", error));
        }

        window.onload = updateUI;
    </script>
</body>
</html>
